\section{Методы определения утечек}

DLP система должна перехватывать все данные, передаваемые с данного устройства, и проверять их на наличие конфиденциальной информации. Задача анализа потока данных является нетривиальной, поскольку передается много разнообразной информации. Вследствие этого поиск оказывается серьезно осложнен. Поэтому разработаны технологии для детектирования попыток передачи конфиденциальных данных.

Условно все способы обнаружения утечек можно разделить на две группы:

\begin{itemize}
	\item
	    анализ текстов передаваемых сообщений или документов
	\item 
	    поиск в данных специальных цифровых отпечатков, меток	    
\end{itemize}


\subsection{Морфологический анализ}

Данный метод ищет в потоке передаваемых данных  заданные слова и словосочетания, поэтому он является одним из самых распространенных контентных способов обнаружения утечек конфиденциальной информации.  Поскольку строгий поиск указанных выражений сам по себе бесполезен, то морфологический поиск должен учитывать все возможные формы заданных слов.

Главным преимуществом является его универсальность. С одной стороны, морфологический анализ может использоваться для контроля любых каналов связи, начиная с файлов, копируемых на съемные накопители, и заканчивая сообщениями в Skype, социальных сетях и пр. С другой – с его помощью могут исследоваться любые тексты и искаться любая информация. При этом конфиденциальные документы не нуждаются в какой-либо предварительной обработке. А защита начинает действовать сразу после включения правил обработки и распространяется на все заданные каналы связи.

Основным недостатком морфологического анализа является относительно низкая эффективность определения конфиденциальной информации. Причем зависит она как от используемых в системе защиты алгоритмов, так и от качества семантического ядра, применяющегося для описания защищаемых данных. Также немалое значение имеют и сами анализируемые тексты. Поэтому заранее предсказать степень эффективности обнаружения в передаваемом трафике конфиденциальных данных достаточно сложно. Увеличить ее можно точным подбором семантического ядра. При использовании морфологического анализа нужно учитывать риск ложного срабатывания системы защиты на вполне безобидные тексты. Его степень также зависит от семантического ядра и исследуемого трафика.

Несмотря на достаточно серьезные недостатки, морфологический анализ на сегодняшний день является единственно возможным методом обнаружения произвольной информации в любых текстах. Данный алгоритм постоянно совершенствуются, что повышает его точность.

В данных алгоритмах зачастую используются словари синонимов, которые позволяют увеличить эффективность морфологического анализа. Они значительно упрощают настройку морфологического анализа. Их использование позволяет при необходимости внесения корректировок в параметры защиты не редактировать вручную все правила, а только изменить состав нужного списка. При этом изменится работа всех правил, в которых используется данный словарь.

Кроме того, в некоторых DLP-решениях существует функция генерации семантического ядра. Она также основана на использовании словарей. Данная функция сканирует указанный набор документов, в ходе которого по специальному алгоритму выбираются слова и выражения, которые используются для описания текстов этого типа. Из них автоматически формируется словарь слов и словосочетаний защищаемых выражений.

\subsection{Статистический анализ}

Данный метод заключается в вероятностном анализе текста, который позволяет предположить его конфиденциальность или открытость. Для его работы обычно требуется предварительное обучение алгоритма. В ходе него вычисляется вероятность нахождения тех или иных слов, а также словосочетаний в конфиденциальных документах.

Преимуществом статистического анализа является его универсальность. При этом данная технология работает в штатном режиме только в рамках поддержания постоянного обучения алгоритма. К примеру, если в процессе обучения системе было предложено недостаточное количество защищаемой информации, то она не сможет определять факт их передачи. То есть качество работы статистического анализа зависит от корректности его настройки (обучения). При этом необходимо учитывать вероятностный характер данной технологии. Она только делает предположение, что анализируемый текст относится к разряду конфиденциальных.

\subsection{Шаблоны}

Во многих случаях конфиденциальная информация представляет собой некоторые стандартизованные данные, например, адреса, телефоны, серии и номера паспортов  и пр. Для обнаружения попыток передачи такой информации существует специальный весьма эффективный метод – шаблоны.

Администратор, отвечающий за безопасность данных, определяет строковый шаблон конфиденциальных данных: количество символов и их тип (буква или цифра). После этого система начинает искать в анализируемых текстах сочетания, удовлетворяющие ему, и применять к найденным файлам или сообщениям указанные в правилах действия.

Главным преимуществом шаблонов является высокая эффективность обнаружения передачи конфиденциальной информации. Применительно к инцидентам случайных утечек она стремится к ста процентам. Однако злоумышленник, зная о возможностях используемой DLP-системы, может противодействовать ей, к примеру, разделяя символы различными символами.

К недостаткам шаблонов можно отнести ограниченную сферу их применения. Они могут использоваться только для стандартизованной информации, например, для защиты персональных данных. Еще одним минусом рассматриваемого метода является относительно высокая частота ложных срабатываний. Например, номер паспорта состоит из шести цифр. Но, если задать такой шаблон, то он будет срабатывать каждый раз, когда встретится шесть цифр подряд. А это может быть номер договора, отсылаемый клиенту, сумма и т. п.

В некоторых DLP-решениях технология шаблонов получила развитие, позволяющее нивелировать описанный выше недостаток. Достигается это за счет ее расширения дополнительными условиями: ключевыми суммами, диапазонами значений, словами, которые находятся неподалеку до или после найденной подстроки. При этом разработчики сами комплектуют поставку уже готовыми шаблонами со всеми необходимыми условиями, так что администратору безопасности остается при создании правила только выбрать нужные значения.

\subsection{Цифровые отпечатки}

Еще одной технологией обнаружения утечек конфиденциальной информации является технология так называемых цифровых отпечатков. С ее помощью можно с высокой степенью эффективности контролировать попытки передачи строго определенных документов или их фрагментов. Сначала создается специальная база «электронных слепков» с указанных администратором файлов. После этого все отправляемые документы будут проверяться на соответствие этим отпечаткам.

Под цифровым отпечатком в данном случае понимается целый набор характерных элементов документа, по которому его можно с высокой достоверностью определить в будущем. Современные DLP-решения способны детектировать не только целые файлы, но и их фрагменты. При этом можно даже рассчитать степень соответствия. Такие решения позволяют создавать дифференцированные правила, в которых описаны разные действия для разных процентов совпадения.

Важной особенностью цифровых отпечатков является то, что они могут использоваться не только для текстовых, но и для табличных документов, а также для изображений. Это открывает широкое поле для применения рассматриваемой технологии. Например, можно сделать цифровой отпечаток подписи главного бухгалтера, что позволит пресечь отправку всех отсканированных копий документов, им подписанных.

\subsection{Цифровые метки}

Данный метод основан на контроле действий над файлами, хранящими защищаемую информацию. На выбранные документы накладываются специальные метки, которые <<видны>> только клиентским модулям используемого DLP-решения. В зависимости от их наличия система разрешает или запрещает те или иные действия с файлами. Это позволяет не только предотвратить утечку конфиденциальных документов, но и ограничить работу с ними пользователей, что является преимуществом данной технологии.

К недостаткам относится ограниченность сферы ее применения. Защитить с ее помощью можно только текстовые документы, причем уже существующие. На вновь создаваемые документы это не распространяется. Частично этот недостаток нивелируется способами автоматического создания меток, например, на основе набора ключевых слов. Однако данный аспект сводит технологию цифровых меток к технологии морфологического анализа, то есть, по сути, к дублированию технологий.

Другим недостатком технологии цифровых меток является легкость ее обхода. Достаточно вручную набрать текст документа в письме, и данный способ будет бессилен. Поэтому он хорош только в сочетании с другими методами защиты.

\subsection{Инструменты противодействия обходу защиты}

Все описанные выше технологии основаны на анализе обычного текста. Однако в некоторых случаях злоумышленники могут использовать различные методы обхода системы защиты, основанные на сокрытии этого текста. Самым простым из них является архивирование пересылаемых документов. Для защиты от этого в DLP-решениях обычно реализуется поддержка разных форматов сжатия. В этом случае файлы распаковываются, а их содержимое проверяется обычным образом. Поэтому в DLP-системе должна присутствовать возможность адекватной реакции на архивы, защищенные паролем. При обнаружении таких файлов они могут, например, перемещаться в карантин.

Следующий способ «спрятать» конфиденциальную информацию – транслитерация. Злоумышленник может взять текст и перевести все его символы на латинский алфавита. Для противодействия транслитерации конфиденциальной информации используется транслитерация заданного семантического ядра. При включении этой функции DLP-система проверяет тексты на наличие как обычно записанных слов, так и их <<транслитерационных>> аналогов. Причем в некоторых решениях правила преобразования можно задавать вручную.

Еще одним способом обхода DLP-системы является отправка текста в виде картинки (например, скриншот открытого документа). Для противодействия этому методу используются OCR-технологии. То есть система защиты пытается распознать все отправляемые изображения. В случае успеха выделенный текст обрабатывается по обычным правилам.